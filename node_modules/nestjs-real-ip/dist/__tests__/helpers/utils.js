"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createServer = void 0;
const platform_fastify_1 = require("@nestjs/platform-fastify");
const testing_1 = require("@nestjs/testing");
async function fastifyExtraWait(adapter, app) {
    if (adapter === platform_fastify_1.FastifyAdapter) {
        const instance = app.getHttpAdapter().getInstance();
        if (instance && typeof instance.ready === 'function') {
            await instance.ready();
        }
    }
}
async function createServer(controller, Adapter) {
    const moduleRef = await testing_1.Test.createTestingModule({
        controllers: [controller],
    }).compile();
    const app = moduleRef.createNestApplication(new Adapter());
    await app.init();
    await fastifyExtraWait(Adapter, app);
    return app;
}
exports.createServer = createServer;
//# sourceMappingURL=utils.js.map